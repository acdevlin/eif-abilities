<div class="container">
  <mat-toolbar color="primary">
    <span>Abilities</span>
  </mat-toolbar>

  <table mat-table class="mat-elevation-z8" [dataSource]="dataSource" matSort>

    <!-- Name Column -->
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Name </th>
      <td mat-cell *matCellDef="let ability">
        <h3>{{ability.name}}</h3>
      </td>
    </ng-container>

    <!-- Weapon Type Column -->
    <ng-container matColumnDef="weaponType">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Weapon Type </th>
      <td mat-cell *matCellDef="let ability"> {{ability.weaponType}} </td>
    </ng-container>

    <!-- Damage Multiplier Column -->
    <ng-container matColumnDef="damageMultiplier">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Damage Mod </th>
      <td mat-cell *matCellDef="let ability"> {{ability.damageMultiplier | number:'1.1-2'}} </td>
    </ng-container>

    <!-- Speed Multiplier Column -->
    <ng-container matColumnDef="speedMultiplier">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Speed Mod </th>
      <td mat-cell *matCellDef="let ability"> {{ability.speedMultiplier | number:'1.1-2'}} </td>
    </ng-container>

    <!-- Accuracy Bonus Column -->
    <ng-container matColumnDef="accuracyBonus">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Accuracy Bonus </th>
      <td mat-cell *matCellDef="let ability"> {{ability.accuracyBonus}} </td>
    </ng-container>

    <!-- HAM Cost Column -->
    <ng-container matColumnDef="hamCosts">
      <th mat-header-cell *matHeaderCellDef> HAM Costs </th>
      <td mat-cell *matCellDef="let ability">
        <mat-list role="list">
          <mat-list-item role="listitem">Health: {{ability.healthCostMultiplier}}</mat-list-item>
          <mat-list-item role="listitem">Action: {{ability.actionCostMultiplier}}</mat-list-item>
          <mat-list-item role="listitem">Mind: {{ability.mindCostMultiplier}}</mat-list-item>
        </mat-list>
    </ng-container>

    <!-- Target HAM Pool Column -->
    <ng-container matColumnDef="poolsToDamage">
      <th mat-header-cell *matHeaderCellDef> Target HAM Pool </th>
      <td mat-cell *matCellDef="let ability">
        <div *ngIf="ability.poolsToDamage; else NoPoolsToDamageCard">
          <mat-card class="mat-elevation-z2" *ngFor="let pool of ability.poolsToDamage"
            [ngStyle]="{'background-color':getTargetPoolColor(pool)}">
            <b>{{pool}}</b>
          </mat-card>
        </div>
        <ng-template #NoPoolsToDamageCard>
          <div *ngIf="ability.damageMultiplier">
            <mat-card class="mat-elevation-z2" [ngStyle]="{'background-color': 'lightgray'}">
              <b>RANDOM_ATTRIBUTE</b>
            </mat-card>
          </div>
        </ng-template>
      </td>
    </ng-container>

    

    <!-- DoT Effects Column -->
    <ng-container matColumnDef="dotEffects">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> DoT Effects </th>
      <td mat-cell *matCellDef="let ability">
        <mat-list role="list" *ngFor="let effect of ability.dotEffects">
          <mat-card class="mat-elevation-z2" [ngStyle]="{'background-color':getDotColor(effect.pool)}">
            <mat-card-title>{{effect.type}}</mat-card-title>
            <mat-card-content>
              <mat-list-item role="listitem">Target Pool: {{effect.pool}}</mat-list-item>
              <mat-list-item role="listitem">Chance: {{effect.chance}}%</mat-list-item>
              <mat-list-item role="listitem">Potency: {{effect.potency}}%</mat-list-item>
              <mat-list-item role="listitem">Strength: {{effect.strength}}%</mat-list-item>
              <mat-list-item role="listitem">Primary Chance: {{effect.primaryPercent}}%</mat-list-item>
              <mat-list-item role="listitem">Secondary Chance: {{effect.secondaryPercent}}%</mat-list-item>
            </mat-card-content>
          </mat-card>
        </mat-list>
    </ng-container>

    <!-- State Effects Column -->
    <ng-container matColumnDef="stateEffects">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> State Effects </th>
      <td mat-cell *matCellDef="let ability">
        <mat-list role="list" *ngFor="let effect of ability.stateEffects">
          <mat-card class="mat-elevation-z2" [ngStyle]="{'background-color':getStateColor(effect.effectType)}">
            <mat-card-title>{{effect.effectType}}</mat-card-title>
            <mat-card-content>
              <mat-list-item role="listitem">Chance: {{effect.stateChance}}%</mat-list-item>
              <mat-list-item role="listitem">Length: {{effect.stateLength}}%</mat-list-item>
              <mat-list-item role="listitem">Strength: {{effect.stateStrength}}%</mat-list-item>
            </mat-card-content>
          </mat-card>
        </mat-list>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; let even = even; columns: displayedColumns;" [ngClass]="{gray: even}"></tr>
  </table>

</div>